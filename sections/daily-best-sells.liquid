{% stylesheet %}
  .daily-best-sells .swiper-button-prev {
    position: absolute;
    left: -60px !important;
    top: 50%;
    transform: translateY(-50%);
    width: 44px;
    height: 44px;
  }
  .daily-best-sells .swiper-button-next {
    position: absolute;
    right: -60px !important;
    top: 50%;
    transform: translateY(-50%);
    width: 44px;
    height: 44px;
  }

  .swiper-button-next:after,
  .swiper-button-prev:after {
    font-size: 15px;
    color: #65a241;
  }
  .swiper-button-next:hover:after,
  .swiper-button-prev:hover:after {
    color: #fff;
  }

  .daily-best-sells .swiper-slide {
    height: auto !important;
  }
  .daily-best-sells .swiper-slide > div {
    height: 100%;
  }

  @media (max-width: 768px) {
    .daily-best-sells .swiper-button-prev,
    .daily-best-sells .swiper-button-next {
      display: none;
    }
  }
{% endstylesheet %}

<div class="daily-best-sells relative">
  <div class="relative container">
    <h2 class="text-2xl lg:text-[32px] font-bold text-heading mb-5 lg:mb-6">{{ section.settings.section_title }}</h2>
    <div class="swiper daily-best-sells-slider">
      <div class="swiper-wrapper">
        {% comment %} Check if using blocks or dynamic products {% endcomment %}
        {% if section.blocks.size > 0 %}
          {% comment %} Use manual blocks if they exist {% endcomment %}
          {% for block in section.blocks %}
            {% assign product = all_products[block.settings.product] %}
            {% if product != blank %}
              <div class="swiper-slide" {{ block.shopify_attributes }}>
                <div class="border border-[#ECECEC] rounded-lg lg:rounded-[14px] p-4 lg:p-5 relative z-1 h-full overflow-hidden">
                  {% if block.settings.show_hot_tag %}
                    <span class="tag absolute z-2 left-0 top-0 rounded-[0_0_8px_0] lg:rounded-[0_0_14px_0] bg-[#F74B81] text-sm text-white h-7.5 w-15 capitalize flex items-center justify-center">
                      hot
                    </span>
                  {% endif %}
                  
                  {% if product.featured_image %}
                    <img 
                      src="{{ product.featured_image | img_url: '400x400' }}" 
                      class="size-50 lg:size-56.5 mx-auto" 
                      width="400" 
                      height="400" 
                      alt="{{ product.featured_image.alt | escape }}"
                      loading="lazy"
                    >
                  {% else %}
                    {{ 'product-1' | placeholder_svg_tag: 'size-50 lg:size-56.5 mx-auto' }}
                  {% endif %}

                  <div class="mt-1">
                    <span class="collection block text-sm text-gray mb-1">{{ product.type }}</span>
                    <h2 class="title text-base md:text-lg text-subheading mb-2.5">
                      <a href="{{ product.url }}">{{ product.title }}</a>
                    </h2>
                    
                    {% if product.metafields.reviews.rating.value %}
                      <div class="flex items-center gap-10 lg:gap-12 mb-1.5">
                        <div class="flex items-center gap-1">
                          {% for i in (1..5) %}
                            <svg
                              class="size-3 {% if i <= product.metafields.reviews.rating.value %}text-yellow-400{% else %}text-gray-300{% endif %}"
                              fill="currentColor"
                              viewBox="0 0 20 20"
                            >
                              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                            </svg>
                          {% endfor %}
                        </div>
                        <p class="review-count text-sm md:text-base text-gray">
                          ({{ product.metafields.reviews.rating_count.value | default: 0 }})
                        </p>
                      </div>
                    {% endif %}
                    
                    <div class="flex items-center gap-2.5">
                      <p class="sell-price text-lg lg:text-xl font-bold text-secondary">
                        {{ product.price | money }}
                      </p>
                      {% if product.compare_at_price > product.price %}
                        <p class="old-price text-sm lg:text-base font-bold text-gray line-through">
                          {{ product.compare_at_price | money }}
                        </p>
                      {% endif %}
                    </div>
                    
                    {% if section.settings.show_sold_progress %}
                      <div class="mt-3 lg:mt-4">
                        <div class="h-1.5 w-full rounded-full bg-[#E9ECEF]">
                          <div class="h-full rounded-full w-[35%] bg-primary"></div>
                        </div>
                        <p class="sold mt-2 text-sm md:text-base text-heading flex items-center gap-1 font-semibold">
                          Sold <span>90/120</span>
                        </p>
                      </div>
                    {% endif %}
                    
                    <button
                      class="btn add-card-btn flex items-center gap-0.5 mt-4 lg:mt-5 max-w-full!"
                      onclick="addToCart({{ product.variants.first.id }})"
                    >
                      <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_8336_522)">
                          <path d="M14 1.72667H2.47333V1.54C2.41111 1.10444 2.21667 0.738889 1.89 0.443334C1.56333 0.147778 1.16667 0 0.7 0H0V1.16667H0.7C0.855556 1.16667 0.987778 1.21333 1.09667 1.30667C1.20556 1.4 1.27556 1.52444 1.30667 1.68L2.24 9.52C2.27111 9.98667 2.45 10.36 2.77667 10.64C3.10333 10.92 3.5 11.0756 3.96667 11.1067H11.6667V9.89333H3.96667C3.81111 9.89333 3.67889 9.84667 3.57 9.75333C3.46111 9.66 3.39111 9.53556 3.36 9.38L3.31333 8.72667H12.74L14 1.72667ZM11.76 7.56H3.17333L2.61333 2.89333H12.6L11.76 7.56ZM2.94 12.8333C2.90889 13.1444 3.01 13.4167 3.24333 13.65C3.47667 13.8833 3.75667 14 4.08333 14C4.41 14 4.68222 13.8833 4.9 13.65C5.11778 13.4167 5.23444 13.1444 5.25 12.8333C5.26556 12.5222 5.15667 12.25 4.92333 12.0167C4.69 11.7833 4.41 11.6667 4.08333 11.6667C3.75667 11.6667 3.48444 11.7833 3.26667 12.0167C3.04889 12.25 2.94 12.5222 2.94 12.8333ZM8.77333 12.8333C8.74222 13.1444 8.84333 13.4167 9.07667 13.65C9.31 13.8833 9.59 14 9.91667 14C10.2433 14 10.5156 13.8833 10.7333 13.65C10.9511 13.4167 11.0678 13.1444 11.0833 12.8333C11.0989 12.5222 10.99 12.25 10.7567 12.0167C10.5233 11.7833 10.2433 11.6667 9.91667 11.6667C9.59 11.6667 9.31778 11.7833 9.1 12.0167C8.88222 12.25 8.77333 12.5222 8.77333 12.8333Z" fill="white"/>
                        </g>
                      </svg>
                      Add
                    </button>
                  </div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        {% else %}
          {% comment %} Use dynamic products from collection {% endcomment %}
          {% assign product_collection = collections[section.settings.collection] | default: collections.all %}
          {% assign max_products = section.settings.max_products | default: 8 %}
          
          {% for product in product_collection.products limit: max_products %}
            <div class="swiper-slide">
              <div class="flex flex-col justify-between border border-[#ECECEC] rounded-lg lg:rounded-[15px] p-4 lg:p-5 relative z-1 h-full">
                {% if section.settings.show_hot_tag %}
                  <span class="tag absolute left-0 top-0 rounded-[0_0_8px_0] lg:rounded-[0_0_14px_0] bg-[#F74B81] text-sm text-white h-7.5 w-15 capitalize flex items-center justify-center">
                    hot
                  </span>
                {% endif %}
                
                {% if product.featured_image %}
                  <img 
                    src="{{ product.featured_image | img_url: '400x400' }}" 
                    class="size-50 lg:size-56.5 mx-auto" 
                    width="400" 
                    height="400" 
                    alt="{{ product.featured_image.alt | escape }}"
                    loading="lazy"
                  >
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'size-50 lg:size-56.5 mx-auto' }}
                {% endif %}

                <div class="mt-1">
                  <span class="collection block text-sm text-gray mb-1">{{ product.type }}</span>
                  <h2 class="title text-base md:text-lg text-subheading mb-2.5">
                    <a href="{{ product.url }}">{{ product.title }}</a>
                  </h2>
                  
                  {% if product.metafields.reviews.rating.value %}
                    <div class="flex items-center gap-10 lg:gap-12 mb-1.5">
                      <div class="flex items-center gap-1">
                        {% for i in (1..5) %}
                          <svg
                            class="size-3 {% if i <= product.metafields.reviews.rating.value %}text-yellow-400{% else %}text-gray-300{% endif %}"
                            fill="currentColor"
                            viewBox="0 0 20 20"
                          >
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                          </svg>
                        {% endfor %}
                      </div>
                      <p class="review-count text-sm md:text-base text-gray">
                        ({{ product.metafields.reviews.rating_count.value | default: 0 }})
                      </p>
                    </div>
                  {% endif %}
                  
                  <div class="flex items-center gap-2.5">
                    <p class="sell-price text-lg lg:text-xl font-bold text-secondary">
                      {{ product.price | money }}
                    </p>
                    {% if product.compare_at_price > product.price %}
                      <p class="old-price text-sm lg:text-base font-bold text-gray line-through">
                        {{ product.compare_at_price | money }}
                      </p>
                    {% endif %}
                  </div>
                  
                  {% if section.settings.show_sold_progress %}
                    <div class="mt-3 lg:mt-4">
                      <div class="h-1.5 w-full rounded-full bg-[#E9ECEF]">
                        <div class="h-full rounded-full w-[35%] bg-primary"></div>
                      </div>
                      <p class="sold mt-2 text-sm md:text-base text-heading flex items-center gap-1 font-semibold">
                        Sold <span>90/120</span>
                      </p>
                    </div>
                  {% endif %}
                  
                  <button
                    class="btn add-card-btn flex items-center gap-0.5 mt-4 lg:mt-5 min-w-full!"
                    onclick="addToCart({{ product.variants.first.id }})"
                  >
                 Add To Cart
                  </button>
                </div>
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>

      <div class="swiper-pagination hidden"></div>
    </div>

    <div class="swiper-button-prev bg-white border border-solid border-[#F0F0F0] hover:bg-[#2E2E2E] transition-all duration-300 rounded-full w-11 h-11 flex items-center justify-center shadow"></div>
    <div class="swiper-button-next bg-white border border-solid border-[#F0F0F0] hover:bg-[#2E2E2E] transition-all duration-300 rounded-full w-11 h-11 flex items-center justify-center shadow"></div>
  </div>
</div>

{% javascript %}
  const swiper = new Swiper('.daily-best-sells-slider', {
    slidesPerView: 1,
    spaceBetween: 16,
    pagination: { el: '.swiper-pagination', clickable: true },
    navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
    breakpoints: {
      320: { slidesPerView: 1, spaceBetween: 12 },
      768: { slidesPerView: 2, spaceBetween: 16 },
      992: { slidesPerView: 3, spaceBetween: 20 },
      1220: { slidesPerView: 4, spaceBetween: 24 },
    },
  });
{% endjavascript %}

{% schema %}
{
  "name": "Daily Best Sells",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Daily Best Sells"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Product Collection",
      "info": "Select a collection to display products from. Leave empty to show from all products. (Only used if no blocks are added)"
    },
    {
      "type": "range",
      "id": "max_products",
      "min": 1,
      "max": 12,
      "step": 1,
      "label": "Maximum Products to Show",
      "default": 8,
      "info": "Only applies when using dynamic products (no blocks)"
    },
    {
      "type": "checkbox",
      "id": "show_hot_tag",
      "label": "Show Hot Tag",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_sold_progress",
      "label": "Show Sold Progress Bar",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "limit": 12,
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        },
        {
          "type": "checkbox",
          "id": "show_hot_tag",
          "label": "Show Hot Tag",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Daily Best Sells",
      "category": "Products"
    }
  ]
}
{% endschema %}